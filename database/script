-- Table clientsBailleurs
CREATE TABLE clientsBailleurs (
  id INT PRIMARY KEY AUTO_INCREMENT,
  nom VARCHAR(255),
  prenom VARCHAR(255),
  adresseMail VARCHAR(255),
  motDePasse VARCHAR(255),
  dateDeNaissance DATE,
  admin BOOLEAN
);

-- Table voyageurs
CREATE TABLE voyageurs (
  id INT PRIMARY KEY AUTO_INCREMENT,
  nom VARCHAR(255),
  prenom VARCHAR(255),
  adresseMail VARCHAR(255),
  motDePasse VARCHAR(255),
  dateDeNaissance DATE,
  admin BOOLEAN
);

-- Table prestataires
CREATE TABLE prestataires (
  id INT PRIMARY KEY AUTO_INCREMENT,
  nom VARCHAR(255),
  prenom VARCHAR(255),
  adresseMail VARCHAR(255),
  motDePasse VARCHAR(255),
  dateDeNaissance DATE,
  admin BOOLEAN
);

-- Table bienImo
CREATE TABLE bienImo (
  id INT PRIMARY KEY AUTO_INCREMENT,
  cheminImg VARCHAR(255),
  id_ClientBailleur INT,
  prix DECIMAL(10, 2),
  nomBien VARCHAR(255),
  description TEXT,
  statutValidation INT,
  disponible INT,
  FOREIGN KEY (id_ClientBailleur) REFERENCES clientsBailleurs(id)
);

-- Table reservation
CREATE TABLE reservation (
  id INT PRIMARY KEY AUTO_INCREMENT,
  id_BienImmobilier INT,
  id_ClientVoyageur INT,
  dateDebut DATE,
  dateFin DATE,
  statut VARCHAR(50),
  FOREIGN KEY (id_BienImmobilier) REFERENCES bienImo(id),
  FOREIGN KEY (id_ClientVoyageur) REFERENCES voyageurs(id)
);

-- Table finances
CREATE TABLE finances (
  id INT PRIMARY KEY AUTO_INCREMENT,
  id_ClientBailleur INT,
  id_Prestataire INT,
  montant DECIMAL(10, 2),
  type VARCHAR(50),
  dateTransaction DATE,
  FOREIGN KEY (id_ClientBailleur) REFERENCES clientsBailleurs(id),
  FOREIGN KEY (id_Prestataire) REFERENCES prestataires(id)
);

-- Table abonnement
CREATE TABLE abonnement (
  id INT PRIMARY KEY AUTO_INCREMENT,
  id_ClientBailleur INT,
  id_Voyageur INT,
  nom VARCHAR(255),
  FOREIGN KEY (id_ClientBailleur) REFERENCES clientsBailleurs(id),
  FOREIGN KEY (id_Voyageur) REFERENCES voyageurs(id),
  CHECK (
    (id_ClientBailleur IS NOT NULL AND id_Voyageur IS NULL) OR
    (id_ClientBailleur IS NULL AND id_Voyageur IS NOT NULL)
  )
); 

-- Table Ã©valuationPrestation
CREATE TABLE evaluationPrestation (
  id INT PRIMARY KEY AUTO_INCREMENT,
  id_BienImmobilier INT,
  id_Prestataire INT,
  typeIntervention VARCHAR(50),
  FOREIGN KEY (id_BienImmobilier) REFERENCES bienImo(id),
  FOREIGN KEY (id_Prestataire) REFERENCES prestataires(id)
);

-- Table prestation
CREATE TABLE prestation (
  id INT PRIMARY KEY AUTO_INCREMENT,
  id_BienImmobilier INT,
  id_Prestataire INT,
  typeIntervention VARCHAR(50),
  FOREIGN KEY (id_BienImmobilier) REFERENCES bienImo(id),
  FOREIGN KEY (id_Prestataire) REFERENCES prestataires(id)
);

-- Table contrat
CREATE TABLE contrat (
  id INT PRIMARY KEY AUTO_INCREMENT,
  id_Reservation INT,
  id_Prestation INT,
  id_Prestataire INT,
  id_Bailleur INT,
  id_Voyageur INT,
  typeContrat VARCHAR(50),
  typeIntervention VARCHAR(50),
  dateDebutContrat DATE,
  dateFinContrat DATE,
  statut VARCHAR(50),
  FOREIGN KEY (id_Reservation) REFERENCES reservation(id),
  FOREIGN KEY (id_Prestation) REFERENCES prestation(id),
  FOREIGN KEY (id_Prestataire) REFERENCES prestataires(id),
  FOREIGN KEY (id_Bailleur) REFERENCES clientsBailleurs(id),
  FOREIGN KEY (id_Voyageur) REFERENCES voyageurs(id)
);

-- Table paiement
CREATE TABLE paiement (
  id INT PRIMARY KEY AUTO_INCREMENT,
  id_Reservation INT,
  montant DECIMAL(10, 2),
  datePaiement DATE,
  methodePaiement VARCHAR(50),
  statut VARCHAR(50),
  FOREIGN KEY (id_Reservation) REFERENCES reservation(id)
);

-- Table facture
CREATE TABLE facture (
  id INT PRIMARY KEY AUTO_INCREMENT,
  id_Reservation INT,
  id_ClientBailleur INT,
  montantTotal DECIMAL(10, 2),
  dateEmission DATE,
  FOREIGN KEY (id_Reservation) REFERENCES reservation(id),
  FOREIGN KEY (id_ClientBailleur) REFERENCES clientsBailleurs(id)
);
